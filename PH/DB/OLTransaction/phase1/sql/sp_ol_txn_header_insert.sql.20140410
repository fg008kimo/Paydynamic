CREATE OR REPLACE FUNCTION sp_ol_txn_header_insert (
   in_txn_id                   ol_txn_header.oth_txn_id%TYPE,
   in_org_txn_id               ol_txn_header.oth_org_txn_id%TYPE,
   in_input_channel            ol_txn_header.oth_input_channel%TYPE,
   in_status                   ol_txn_header.oth_status%TYPE,
   in_ar_ind                   ol_txn_header.oth_ar_ind%TYPE,
   in_sub_status               ol_txn_header.oth_sub_status%TYPE,
   in_txn_code                 ol_txn_header.oth_txn_code%TYPE,
   in_process_type             ol_txn_header.oth_process_type%TYPE,
   in_process_code             ol_txn_header.oth_process_code%TYPE,
   in_merchant_id              ol_txn_header.oth_merchant_id%TYPE,
   in_merchant_ref             ol_txn_header.oth_merchant_ref%TYPE,
   in_client_id                ol_txn_header.oth_client_id%TYPE,
   in_host_posting_date        ol_txn_header.oth_host_posting_date%TYPE,
   in_transmission_datetime    ol_txn_header.oth_transmission_datetime%TYPE,
   in_internal_code            ol_txn_header.oth_internal_code%TYPE,
   in_response_code            ol_txn_header.oth_response_code%TYPE,
   in_transaction_amt          ol_txn_header.oth_transaction_amount%TYPE,
   in_deposit_amt              ol_txn_header.oth_deposit_amount%TYPE,
   in_display_amt              ol_txn_header.oth_display_amount%TYPE,
   in_net_amt                  ol_txn_header.oth_net_amount%TYPE,
   in_filename                 ol_txn_header.oth_filename%TYPE,
   in_tm_date                  ol_txn_header.oth_tm_date%TYPE,
   in_tm_time                  ol_txn_header.oth_tm_time%TYPE,
   in_local_tm_date            ol_txn_header.oth_local_tm_date%TYPE,
   in_local_tm_time            ol_txn_header.oth_local_tm_time%TYPE,
   in_create_user              ol_txn_header.oth_create_user%TYPE,
   in_update_user              ol_txn_header.oth_update_user%TYPE,
   in_client_ip                ol_txn_header.oth_client_ip%TYPE,
   in_service_code             ol_txn_header.oth_service_code%TYPE,
   in_approval_date            ol_txn_header.oth_approval_date%TYPE,
   in_upd_match_ts             CHAR,
   in_upload_channel           ol_txn_header.oth_upload_channel%TYPE)
   RETURN NUMBER
IS
BEGIN
   INSERT INTO ol_txn_header (oth_txn_id,
                              oth_org_txn_id,
                              oth_input_channel,
                              oth_status,
                              oth_ar_ind,
                              oth_sub_status,
                              oth_txn_code,
                              oth_process_type,
                              oth_process_code,
                              oth_merchant_id,
                              oth_merchant_ref,
                              oth_client_id,
                              oth_host_posting_date,
                              oth_transmission_datetime,
                              oth_internal_code,
                              oth_response_code,
                              oth_transaction_amount,
                              oth_deposit_amount,
                              oth_display_amount,
                              oth_net_amount,
                              oth_filename,
                              oth_tm_date,
                              oth_tm_time,
                              oth_local_tm_date,
                              oth_local_tm_time,
                              oth_create_user,
                              oth_create_timestamp,
                              oth_update_user,
                              oth_update_timestamp,
                              oth_client_ip,
                              oth_service_code,
                              oth_approval_date,
                              oth_matching_timestamp,
                              oth_upload_channel)
        VALUES (in_txn_id,
                in_org_txn_id,
                in_input_channel,
                in_status,
                in_ar_ind,
                in_sub_status,
                in_txn_code,
                in_process_type,
                in_process_code,
                in_merchant_id,
                in_merchant_ref,
                in_client_id,
                in_host_posting_date,
                in_transmission_datetime,
                in_internal_code,
                in_response_code,
                in_transaction_amt,
                in_deposit_amt,
                in_display_amt,
                in_net_amt,
                in_filename,
                in_tm_date,
                in_tm_time,
                in_local_tm_date,
                in_local_tm_time,
                in_create_user,
                SYSDATE,
                in_update_user,
                SYSDATE,
                in_client_ip,
                in_service_code,
                in_approval_date,
                DECODE (in_upd_match_ts, 'Y', SYSDATE, NULL),
                in_upload_channel);

   IF SQL%ROWCOUNT = 0
   THEN
      RETURN 1;
   ELSE
      RETURN 0;
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      RETURN 9;
END sp_ol_txn_header_insert;
/
