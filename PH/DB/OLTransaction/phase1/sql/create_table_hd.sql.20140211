ALTER TABLE OL_TXN_HEADER
 DROP PRIMARY KEY CASCADE;

DROP TABLE OL_TXN_HEADER CASCADE CONSTRAINTS;

CREATE TABLE OL_TXN_HEADER
(
  OTH_TXN_ID                 VARCHAR2(16 BYTE)  NOT NULL,
  OTH_ORG_TXN_ID             VARCHAR2(16 BYTE),
  OTH_DST_TXN_ID             VARCHAR2(16 BYTE),
  OTH_INPUT_CHANNEL          VARCHAR2(3 BYTE),
  OTH_STATUS                 CHAR(1 BYTE),
  OTH_AR_IND                 CHAR(1 BYTE),
  OTH_TXN_CODE               VARCHAR2(3 BYTE),
  OTH_PROCESS_TYPE           VARCHAR2(4 BYTE),
  OTH_PROCESS_CODE           VARCHAR2(6 BYTE),
  OTH_CLIENT_ID              VARCHAR2(10 BYTE),
  OTH_MERCHANT_ID            VARCHAR2(15 BYTE),
  OTH_MERCHANT_REF           VARCHAR2(50 BYTE),
  OTH_HOST_POSTING_DATE      VARCHAR2(8 BYTE),
  OTH_TRANSMISSION_DATETIME  VARCHAR2(14 BYTE),
  OTH_INTERNAL_CODE          NUMBER(8),
  OTH_RESPONSE_CODE          VARCHAR2(6 BYTE),
  OTH_TRANSACTION_AMOUNT     NUMBER(12,2)       DEFAULT 0,
  OTH_NET_AMOUNT             NUMBER(12,2)       DEFAULT 0,
  OTH_DEPOSIT_AMOUNT         NUMBER(12,2)	DEFAULT 0,
  OTH_DISPLAY_AMOUNT         NUMBER(12,2)	DEFAULT 0,
  OTH_FILENAME               VARCHAR2(100 BYTE),
  OTH_TM_DATE                VARCHAR2(8 BYTE),
  OTH_TM_TIME                VARCHAR2(6 BYTE),
  OTH_LOCAL_TM_DATE          VARCHAR2(8 BYTE),
  OTH_LOCAL_TM_TIME          VARCHAR2(6 BYTE),
  OTH_CLIENT_IP              VARCHAR2(25 BYTE),
  OTH_SERVICE_CODE           VARCHAR2(3 BYTE),
  OTH_APPROVAL_DATE          VARCHAR2(8 BYTE),
  OTH_EX_SUPPLIER            CHAR(1 BYTE),
  OTH_EX_RATE                NUMBER(14,5),
  OTH_NET_CCY                CHAR(3 BYTE),
  OTH_APPROVAL_TIMESTAMP     TIMESTAMP(6),
  OTH_SETTLEMENT_TXN_AMOUNT  NUMBER(12,2),
  OTH_SUB_STATUS             CHAR(3 BYTE),
  OTH_INTER_CCY              CHAR(3 BYTE),
  OTH_CREATE_USER            VARCHAR2(20 BYTE),
  OTH_CREATE_TIMESTAMP       DATE               DEFAULT sysdate,
  OTH_UPDATE_USER            VARCHAR2(20 BYTE),
  OTH_UPDATE_TIMESTAMP       DATE               DEFAULT sysdate
)
TABLESPACE USER_DATA
RESULT_CACHE (MODE DEFAULT)
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          2M
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;

COMMENT ON COLUMN OL_TXN_HEADER.OTH_STATUS IS 'C for complete P for Process';

COMMENT ON COLUMN OL_TXN_HEADER.OTH_TXN_CODE IS 'A for Accept R for Reject';



CREATE INDEX OL_TXN_HEADER_IDX01 ON OL_TXN_HEADER
(OTH_MERCHANT_ID, OTH_MERCHANT_REF)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          384K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX02 ON OL_TXN_HEADER
(OTH_APPROVAL_DATE)
LOGGING
TABLESPACE USER_DATA
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX03 ON OL_TXN_HEADER
(OTH_SERVICE_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          128K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX04 ON OL_TXN_HEADER
(OTH_TXN_ID, OTH_STATUS, OTH_AR_IND)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX05 ON OL_TXN_HEADER
(OTH_TXN_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX06 ON OL_TXN_HEADER
(OTH_TXN_CODE, OTH_STATUS, OTH_AR_IND, OTH_APPROVAL_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX07 ON OL_TXN_HEADER
(OTH_TXN_ID, OTH_STATUS, OTH_AR_IND, OTH_TXN_CODE, OTH_MERCHANT_ID, 
OTH_APPROVAL_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX08 ON OL_TXN_HEADER
(OTH_TXN_ID, OTH_TXN_CODE, OTH_MERCHANT_ID, OTH_HOST_POSTING_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX09 ON OL_TXN_HEADER
(OTH_INPUT_CHANNEL, OTH_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX10 ON OL_TXN_HEADER
(OTH_HOST_POSTING_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX11 ON OL_TXN_HEADER
(OTH_UPDATE_TIMESTAMP)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX12 ON OL_TXN_HEADER
(OTH_ORG_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX13 ON OL_TXN_HEADER
(OTH_CREATE_TIMESTAMP, OTH_TXN_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX14 ON OL_TXN_HEADER
(OTH_MERCHANT_ID, OTH_SERVICE_CODE, OTH_TXN_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX16 ON OL_TXN_HEADER
(OTH_TXN_CODE, OTH_APPROVAL_DATE, OTH_MERCHANT_ID, OTH_SERVICE_CODE, OTH_AR_IND, 
OTH_STATUS)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX17 ON OL_TXN_HEADER
("OTH_UPDATE_TIMESTAMP" DESC, OTH_TXN_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX18 ON OL_TXN_HEADER
(OTH_TXN_CODE, OTH_HOST_POSTING_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX21 ON OL_TXN_HEADER
(OTH_APPROVAL_TIMESTAMP)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_TXN_HEADER_IDX22 ON OL_TXN_HEADER
(OTH_TXN_CODE, OTH_MERCHANT_ID, OTH_CREATE_TIMESTAMP, OTH_DISPLAY_AMOUNT)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_TXN_HEADER_IDX23 ON OL_TXN_HEADER
(OTH_FILENAME, OTH_APPROVAL_DATE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE INDEX OL_TXN_HEADER_IDX24 ON OL_TXN_HEADER
(OTH_DST_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE UNIQUE INDEX OL_TXN_HEADER_PK ON OL_TXN_HEADER
(OTH_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          256K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


ALTER TABLE OL_TXN_HEADER ADD (
  CONSTRAINT OL_TXN_HEADER_PK
  PRIMARY KEY
  (OTH_TXN_ID)
  USING INDEX OL_TXN_HEADER_PK
  ENABLE VALIDATE);

ALTER TABLE OL_TXN_HEADER ADD (
  CONSTRAINT OL_TXN_HEADER_FK01 
  FOREIGN KEY (OTH_SUB_STATUS) 
  REFERENCES DEF_SUB_STATUS (DS_SUB_STATUS)
  ENABLE VALIDATE);

