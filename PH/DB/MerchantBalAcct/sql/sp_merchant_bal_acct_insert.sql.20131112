CREATE OR REPLACE FUNCTION sp_merchant_bal_acct_insert(
	in_merchant_id		merchant_bal_acct.mb_merchant_id%type,
	in_country		merchant_bal_acct.mb_country%type,
	in_ccy			merchant_bal_acct.mb_ccy_id%type,
	in_disabled		merchant_bal_acct.mb_disabled%type,
	in_service_code		merchant_bal_acct.mb_service_code%type,
	in_status		merchant_bal_acct.mb_status%type,
	in_txn_type		merchant_bal_acct.mb_txn_type%type,
	in_support_delta_amt    merchant_bal_acct.mb_support_delta_amt%type,
	in_preferred_settle_ccy	merchant_bal_acct.mb_preferred_settle_ccy%type,
	in_min_settle_amt	merchant_bal_acct.mb_min_settle_amt%type,
	in_avai_po_percentage	merchant_bal_acct.mb_avai_po_percentage%type,
	in_create_user		merchant_bal_acct.mb_create_user%type)
  RETURN NUMBER IS

BEGIN
  INSERT INTO merchant_bal_acct(
	mb_merchant_id,
	mb_country,
	mb_ccy_id,
	mb_disabled,
	mb_service_code,
	mb_status,
	mb_txn_type,
	mb_support_delta_amt,
	mb_preferred_settle_ccy,
	mb_min_settle_amt,
	mb_avai_po_percentage,
	mb_create_user,
	mb_create_timestamp,
	mb_update_user,
	mb_update_timestamp
	)
  VALUES(
	in_merchant_id,
	in_country,
	in_ccy,
        in_disabled,
	in_service_code,
	in_status,
	in_txn_type,
	in_support_delta_amt,
	in_preferred_settle_ccy,
	in_min_settle_amt,
	in_avai_po_percentage,
	in_create_user,
	sysdate,
	in_create_user,
	sysdate
	);

  IF SQL%ROWCOUNT = 0 THEN
     RETURN 1;
  ELSE
     RETURN 0;
  END IF;

EXCEPTION
  WHEN OTHERS THEN
     RETURN 9;

END sp_merchant_bal_acct_insert;
/

