ALTER TABLE CRR_JNL_HEADER
 DROP PRIMARY KEY CASCADE;

DROP TABLE CRR_JNL_HEADER CASCADE CONSTRAINTS;

CREATE TABLE CRR_JNL_HEADER
(
	JNL_ID		VARCHAR2(16) NOT NULL,
	JNL_TYPE_ID INT NOT NULL,
	DESCRIPTION		VARCHAR2(100)	NULL,
	TXN_DATE	VARCHAR2(8)	NULL,
	BANK_UPDATE_DATE	VARCHAR2(8)	NULL,
	ACC_YEAR	VARCHAR2(4) NULL,
	ACC_MONTH	VARCHAR2(2)	NULL,
	REF_NO	VARCHAR2(100) NULL,
	PRODUCT_CODE    CHAR(3) NOT NULL,
	COUNTRY_CODE    CHAR(2) NOT NULL,	
	REMARKS	VARCHAR2(300) NULL,
	STATUS	CHAR(1)	NOT NULL,
	DISABLED	NUMBER(1)	DEFAULT 0,
	CREATE_TIMESTAMP	DATE	DEFAULT SYSDATE,
	CREATE_USER	VARCHAR2(20),
	UPDATE_TIMESTAMP	DATE	DEFAULT SYSDATE,
	UPDATE_USER	VARCHAR2(20),
	APPROVE_TIMESTAMP	DATE	NULL,
	APPROVE_USER	VARCHAR2(20) NULL,
	BOOK_TIMESTAMP	DATE	NULL,
	BOOK_USER	VARCHAR2(20) NULL	
)
TABLESPACE USER_DATA
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;

CREATE UNIQUE INDEX CRR_JNL_HEADER_PK ON CRR_JNL_HEADER
(JNL_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;

CREATE INDEX CRR_JNL_HEADER_IDX01 ON CRR_JNL_HEADER
(JNL_ID, JNL_TYPE_ID, TXN_DATE, PRODUCT_CODE, COUNTRY_CODE, STATUS, DISABLED)
LOGGING
TABLESPACE USER_DATA
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;


ALTER TABLE CRR_JNL_HEADER ADD (
  CONSTRAINT CRR_JNL_HEADER_PK
  PRIMARY KEY
  (JNL_ID)
  USING INDEX CRR_JNL_HEADER_PK);

ALTER TABLE CRR_JNL_HEADER ADD (
  CONSTRAINT CRR_JNL_HEADER_FK01
  FOREIGN KEY (JNL_TYPE_ID) 
  REFERENCES CRR_JNL_TYPE (JNL_TYPE_ID));  

ALTER TABLE CRR_JNL_HEADER ADD (
  CONSTRAINT CRR_JNL_HEADER_FK02
  FOREIGN KEY (PRODUCT_CODE) 
  REFERENCES PRODUCT (PRODUCT_CODE)); 

ALTER TABLE CRR_JNL_HEADER ADD (
  CONSTRAINT CRR_JNL_HEADER_FK03
  FOREIGN KEY (COUNTRY_CODE) 
  REFERENCES COUNTRY (COUNTRY_CODE)); 

ALTER TABLE CRR_JNL_HEADER ADD
 CONSTRAINT CRR_JNL_HEADER_CK01
   CHECK (
   	 STATUS IN ('P','A','B')
   );
  
DROP SEQUENCE CRR_JNL_HEADER_SEQ;

CREATE SEQUENCE CRR_JNL_HEADER_SEQ
START WITH 1
INCREMENT BY 1
NOMAXVALUE; 