CREATE OR REPLACE FUNCTION sp_ol_statement_detail_insert(
	in_filename		ol_statement_detail.olsd_filename%type,
	in_int_bank_code	ol_statement_detail.olsd_int_bank_code%type,
	in_bank_acct_num	ol_statement_detail.olsd_bank_acct_num%type,
	in_statement_seq	ol_statement_detail.olsd_statement_seq%type,
	in_txn_id		ol_statement_detail.olsd_txn_id%type,
	in_sms_txn_id		ol_statement_detail.olsd_sms_txn_id%type,
	in_status		ol_statement_detail.olsd_status%type,
	in_statement_date	ol_stmt_format_template.olft_format_template%type,
	in_statement_date_t	ol_stmt_format_template.olft_format_template%type,
	in_statement_time	ol_stmt_format_template.olft_format_template%type,
	in_statement_time_t	ol_stmt_format_template.olft_format_template%type,
	in_tfr_bank_name	ol_statement_detail.olsd_tfr_bank_name%type,
	in_tfr_bank_acct_num	ol_statement_detail.olsd_tfr_bank_acct_num%type,
	in_tfr_type		ol_statement_detail.olsd_tfr_type%type,
	in_tfr_channel		ol_statement_detail.olsd_tfr_channel%type,
	in_tfr_text		ol_statement_detail.olsd_tfr_text%type,
	in_tfr_customer_text	ol_statement_detail.olsd_tfr_customer_text%type,
	in_balance		ol_statement_detail.olsd_balance%type,
	in_amt_type		ol_statement_detail.olsd_amt_type%type,
	in_txn_amount		ol_statement_detail.olsd_txn_amount%type,
	in_txn_ccy		ol_statement_detail.olsd_txn_ccy%type,
	in_create_user		ol_statement_detail.olsd_create_user%type)
  RETURN NUMBER IS
	out_of_date	EXCEPTION;
	out_of_time	EXCEPTION;
	stmt_date	ol_statement_detail.olsd_statement_date%type;
	stmt_time	ol_statement_detail.olsd_statement_time%type;
BEGIN

		SELECT	CASE WHEN in_statement_date_t is not null THEN
				to_char(to_date(in_statement_date,in_statement_date_t),'YYYYMMDD')
				ELSE in_statement_date
			END
		INTO	stmt_date
		FROM	DUAL;


		SELECT	CASE WHEN in_statement_time_t is not null THEN 
				to_char(to_date(in_statement_time,in_statement_time_t),'HH24MISS')
				ELSE in_statement_time
			END
		INTO	stmt_time
		FROM	DUAL;


	INSERT INTO ol_statement_detail (
		olsd_filename,
		olsd_int_bank_code,
		olsd_bank_acct_num,
		olsd_statement_seq,
		olsd_txn_id,
		olsd_sms_txn_id,
		olsd_status,
		olsd_statement_date,
		olsd_statement_time,
		olsd_tfr_bank_name,
		olsd_tfr_bank_acct_num,
		olsd_tfr_type,
		olsd_tfr_channel,
		olsd_tfr_text,
		olsd_tfr_customer_text,
		olsd_balance,
		olsd_amt_type,
		olsd_txn_amount,
		olsd_txn_ccy,
		olsd_create_timestamp,
		olsd_create_user,
		olsd_update_timestamp,
		olsd_update_user
		)
	VALUES (	
		in_filename,
		in_int_bank_code,
		in_bank_acct_num,
		in_statement_seq,
		in_txn_id,
		in_sms_txn_id,
		in_status,
		stmt_date,
		stmt_time,
		in_tfr_bank_name,
		in_tfr_bank_acct_num,
		in_tfr_type,
		in_tfr_channel,
		in_tfr_text,
		in_tfr_customer_text,
		in_balance,
		in_amt_type,
		in_txn_amount,
		in_txn_ccy,
		sysdate,
		in_create_user,
		sysdate,
		in_create_user
		);

	IF SQL%ROWCOUNT = 0 THEN
		RETURN 1;
	ELSE
		RETURN 0;
	END IF;

EXCEPTION
	WHEN OTHERS THEN	
		raise_application_error(-20001,DBMS_UTILITY.FORMAT_ERROR_BACKTRACE);
		RETURN 9;

END sp_ol_statement_detail_insert;
/
