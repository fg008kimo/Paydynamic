DROP TABLE OL_STATEMENT_DETAIL CASCADE CONSTRAINTS;

CREATE TABLE OL_STATEMENT_DETAIL
(
  OLSD_STAT_TXN_ID         VARCHAR2(16 BYTE),
  OLSD_FILENAME            VARCHAR2(100 BYTE),
  OLSD_INT_BANK_CODE       VARCHAR2(10 BYTE),
  OLSD_BANK_ACCT_NUM       VARCHAR2(50 BYTE),
  OLSD_BAID                VARCHAR2(20 BYTE),
  OLSD_STATEMENT_SEQ       INTEGER,
  OLSD_TXN_ID              VARCHAR2(16 BYTE),
  OLSD_STATEMENT_REF       VARCHAR2(16 BYTE),
  OLSD_INPUT_CHANNEL       VARCHAR2(10 BYTE),
  OLSD_STATEMENT_DATE      VARCHAR2(8 BYTE),
  OLSD_STATEMENT_TIME      VARCHAR2(6 BYTE),
  OLSD_STATEMENT_TIMESTAMP DATE,
  OLSD_TFR_BANK_NAME       VARCHAR2(100 BYTE),
  OLSD_TFR_BANK_ACCT_NUM   VARCHAR2(50 BYTE),
  OLSD_TFR_TYPE            VARCHAR2(50 BYTE),
  OLSD_TFR_CHANNEL         VARCHAR2(100 BYTE),
  OLSD_TFR_TEXT            VARCHAR2(100 BYTE),
  OLSD_TFR_CUSTOMER_TEXT   VARCHAR2(100 BYTE),
  OLSD_SENDER_NAME         VARCHAR2(100 BYTE),
  OLSD_TXN_REF_NUM         VARCHAR2(50 BYTE),
  OLSD_KEYWORDS_MAPPING    VARCHAR2(200 BYTE),
  OLSD_BALANCE             NUMBER(14,2)          DEFAULT 0,
  OLSD_AMT_TYPE            CHAR(2 BYTE),
  OLSD_TXN_AMOUNT          NUMBER(12,2),
  OLSD_TXN_CCY             VARCHAR2(3 BYTE),
  OLSD_CREATE_TIMESTAMP    DATE                  DEFAULT sysdate,
  OLSD_CREATE_USER         VARCHAR2(20 BYTE),
  OLSD_UPDATE_TIMESTAMP    DATE                  DEFAULT sysdate,
  OLSD_UPDATE_USER         VARCHAR2(20 BYTE)
)
TABLESPACE USER_DATA
RESULT_CACHE (MODE DEFAULT)
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE UNIQUE INDEX OL_STATEMENT_DETAIL_IDX01 ON OL_STATEMENT_DETAIL
(OLSD_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE UNIQUE INDEX OL_STATEMENT_DETAIL_IDX03 ON OL_STATEMENT_DETAIL
(OLSD_STATEMENT_REF)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE UNIQUE INDEX OL_STATEMENT_DETAIL_IDX04 ON OL_STATEMENT_DETAIL
(OLSD_FILENAME, OLSD_STATEMENT_SEQ) 
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX05 ON OL_STATEMENT_DETAIL
(OLSD_INT_BANK_CODE, OLSD_BANK_ACCT_NUM, OLSD_STATEMENT_TIMESTAMP, OLSD_STATEMENT_REF)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX06 ON OL_STATEMENT_DETAIL
(OLSD_INT_BANK_CODE, OLSD_BANK_ACCT_NUM, OLSD_STATEMENT_DATE, OLSD_TXN_AMOUNT, OLSD_BALANCE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE UNIQUE INDEX OL_STATEMENT_DETAIL_PK ON OL_STATEMENT_DETAIL
(OLSD_STAT_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          256K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


ALTER TABLE OL_STATEMENT_DETAIL ADD (
  CONSTRAINT OL_STATEMENT_DETAIL_PK
  PRIMARY KEY
  (OLSD_STAT_TXN_ID)
  USING INDEX OL_STATEMENT_DETAIL_PK
  ENABLE VALIDATE);


ALTER TABLE OL_STATEMENT_DETAIL ADD (
  CONSTRAINT OL_STATEMENT_DETAIL_FK01 
  FOREIGN KEY (OLSD_INT_BANK_CODE, OLSD_BANK_ACCT_NUM) 
  REFERENCES OL_BANK_ACCTS (OB_INT_BANK_CODE,OB_BANK_ACCT_NUM)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK02
  FOREIGN KEY (OLSD_TXN_CCY) 
  REFERENCES DEF_CURRENCY (DC_CCY_ID)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK03
  FOREIGN KEY (OLSD_AMT_TYPE) 
  REFERENCES DEF_AMT_TYPE (DA_TYPE)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK05
  FOREIGN KEY (OLSD_TXN_ID) 
  REFERENCES OL_BAID_TXN (OBT_TXN_ID)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK06
  FOREIGN KEY (OLSD_INPUT_CHANNEL)
  REFERENCES OL_DEF_INPUT_CHANNEL (DI_INPUT_CHANNEL)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK07
  FOREIGN KEY (OLSD_BAID)
  REFERENCES OL_BANK_ACCT_ID (OBAI_BAID)
  ENABLE VALIDATE);

