ALTER TABLE OL_STATEMENT_DETAIL
 DROP PRIMARY KEY CASCADE;

DROP TABLE OL_STATEMENT_DETAIL CASCADE CONSTRAINTS;

CREATE TABLE OL_STATEMENT_DETAIL
(
  OLSD_FILENAME           VARCHAR2(50 BYTE),
  OLSD_INT_BANK_CODE      VARCHAR2(10 BYTE),
  OLSD_BANK_ACCT_NUM      VARCHAR2(50 BYTE),
  OLSD_STATEMENT_SEQ      INTEGER               DEFAULT 1,
  OLSD_TXN_ID             VARCHAR2(16 BYTE),
  OLSD_SMS_TXN_ID         VARCHAR2(16 BYTE),
  OLSD_STATEMENT_REF      VARCHAR2(16 BYTE),
  OLSD_INPUT_CHANNEL      VARCHAR2(10 BYTE),
  OLSD_STATUS             CHAR(1 BYTE),
  OLSD_STATEMENT_DATE     VARCHAR2(8 BYTE),
  OLSD_STATEMENT_TIME     VARCHAR2(6 BYTE),
  OLSD_TFR_BANK_NAME      VARCHAR2(100 BYTE),
  OLSD_TFR_BANK_ACCT_NUM  VARCHAR2(50 BYTE),
  OLSD_TFR_TYPE           VARCHAR2(50 BYTE),
  OLSD_TFR_CHANNEL        VARCHAR2(100 BYTE),
  OLSD_TFR_TEXT           VARCHAR2(100 BYTE),
  OLSD_TFR_CUSTOMER_TEXT  VARCHAR2(100 BYTE),
  OLSD_BALANCE            NUMBER(14,2)          DEFAULT 0,
  OLSD_AMT_TYPE           CHAR(2 BYTE),
  OLSD_TXN_AMOUNT         NUMBER(14,2),
  OLSD_TXN_CCY            VARCHAR2(3 BYTE),
  OLSD_CREATE_TIMESTAMP   DATE                  DEFAULT sysdate,
  OLSD_CREATE_USER        VARCHAR2(20 BYTE),
  OLSD_UPDATE_TIMESTAMP   DATE                  DEFAULT sysdate,
  OLSD_UPDATE_USER        VARCHAR2(20 BYTE)
)
TABLESPACE USER_DATA
RESULT_CACHE (MODE DEFAULT)
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE INDEX OL_STATEMENT_DETAIL_IDX01 ON OL_STATEMENT_DETAIL
(OLSD_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX02 ON OL_STATEMENT_DETAIL
(OLSD_SMS_TXN_ID)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX03 ON OL_STATEMENT_DETAIL
(OLSD_STATEMENT_REF)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX04 ON OL_STATEMENT_DETAIL
(OLSD_TXN_AMOUNT, OLSD_STATEMENT_DATE, OLSD_INT_BANK_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX05 ON OL_STATEMENT_DETAIL
(OLSD_BALANCE, OLSD_STATEMENT_DATE, OLSD_INT_BANK_CODE)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

CREATE INDEX OL_STATEMENT_DETAIL_IDX06 ON OL_STATEMENT_DETAIL
(OLSD_STATEMENT_DATE, OLSD_STATEMENT_TIME, OLSD_STATUS, OLSD_INPUT_CHANNEL)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


CREATE UNIQUE INDEX OL_STATEMENT_DETAIL_PK ON OL_STATEMENT_DETAIL
(OLSD_FILENAME, OLSD_BANK_ACCT_NUM, OLSD_STATEMENT_SEQ)
LOGGING
TABLESPACE USER_IDX
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;


ALTER TABLE OL_STATEMENT_DETAIL ADD (
  CONSTRAINT OL_STATEMENT_DETAIL_PK
  PRIMARY KEY
  (OLSD_FILENAME, OLSD_BANK_ACCT_NUM, OLSD_STATEMENT_SEQ)
  USING INDEX OL_STATEMENT_DETAIL_PK
  ENABLE VALIDATE);

ALTER TABLE OL_STATEMENT_DETAIL ADD (
  CONSTRAINT OL_STATEMENT_DETAIL_FK01 
  FOREIGN KEY (OLSD_INT_BANK_CODE, OLSD_BANK_ACCT_NUM) 
  REFERENCES OL_BANK_ACCTS (OB_INT_BANK_CODE,OB_BANK_ACCT_NUM)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK02
  FOREIGN KEY (OLSD_TXN_CCY) 
  REFERENCES DEF_CURRENCY (DC_CCY_ID)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK03
  FOREIGN KEY (OLSD_AMT_TYPE) 
  REFERENCES DEF_AMT_TYPE (DA_TYPE)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK04
  FOREIGN KEY (OLSD_FILENAME) 
  REFERENCES OL_STATEMENT_HEADER (OLSH_FILENAME)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK05
  FOREIGN KEY (OLSD_STATUS) 
  REFERENCES DEF_STATEMENT_STATUS (DSS_TYPE)
  ENABLE VALIDATE,
  CONSTRAINT OL_STATEMENT_DETAIL_FK06
  FOREIGN KEY (OLSD_TXN_ID) 
  REFERENCES OL_TXN_HEADER (OTH_TXN_ID)
  ENABLE VALIDATE);

