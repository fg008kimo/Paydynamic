create or replace function sp_mms_txn_detail_insert(
       in_txn_id                                mms_txn_detail.mtd_txn_id%type,
       in_dtl_txn_id                            mms_txn_detail.mtd_dtl_txn_id%type,
       in_org_dtl_txn_id                        mms_txn_detail.mtd_org_dtl_txn_id%type,
       in_init_channel                          mms_txn_detail.mtd_init_channel%type,
       in_txn_code                              mms_txn_detail.mtd_txn_code%type,
       in_merchant_id                           mms_txn_detail.mtd_merchant_id%type,
       in_psp_id    				mms_txn_detail.mtd_psp_id%type,
       in_mb_id					mms_txn_detail.mtd_mb_id%type,
       in_bank_id                               mms_txn_detail.mtd_bank_id%type,
       in_party_node_id                         mms_txn_detail.mtd_party_node_id%type,
       in_status				mms_txn_detail.mtd_status%type,
       in_ar_ind				mms_txn_detail.mtd_ar_ind%type,
       in_transmission_datetime	 	 	mms_txn_detail.mtd_transmission_datetime%type,
       in_isd_ind                               mms_txn_detail.mtd_isd_ind%type,
       in_txn_amt				mms_txn_detail.mtd_txn_amt%type,
       in_txn_ccy				mms_txn_detail.mtd_txn_ccy%type,
       in_adjustment				mms_txn_detail.mtd_adjustment%type,
       in_exchange_rate				mms_txn_detail.mtd_exchange_rate%type,
       in_processing_cost			mms_txn_detail.mtd_processing_cost%type,
       in_bank_charge				mms_txn_detail.mtd_bank_charge%type,
       in_bank_charge_refund			mms_txn_detail.mtd_bank_charge_refund%type,
       in_filing_number				mms_txn_detail.mtd_filing_number%type,
       in_country                               mms_txn_detail.mtd_country%type,
       in_encrypt_type                          mms_txn_detail.mtd_encrypt_type%type,
       in_version_no                            mms_txn_detail.mtd_version_no%type,
       in_create_user				mms_txn_detail.mtd_create_user%type,
       in_update_user				mms_txn_detail.mtd_update_user%type
)
  RETURN NUMBER IS
Begin
     Update mms_txn_detail
     	set mtd_org_dtl_txn_id = in_org_dtl_txn_id,
	    mtd_txn_code = in_txn_code,	
            mtd_init_channel = in_init_channel,
            mtd_merchant_id = in_merchant_id,
            mtd_psp_id = in_psp_id,
            mtd_mb_id = in_mb_id,
            mtd_bank_id = in_bank_id, 
            mtd_party_node_id = in_party_node_id,	
            mtd_status = in_status,
            mtd_ar_ind = in_ar_ind,
	    mtd_transmission_datetime = in_transmission_datetime,
            mtd_isd_ind = in_isd_ind,
	    mtd_txn_amt = in_txn_amt,
	    mtd_txn_ccy = in_txn_ccy,
	    mtd_adjustment = in_adjustment,
	    mtd_exchange_rate = in_exchange_rate,
	    mtd_processing_cost = in_processing_cost,
	    mtd_bank_charge = in_bank_charge,
	    mtd_bank_charge_refund = in_bank_charge_refund,
	    mtd_filing_number = in_filing_number,
            mtd_country = in_country,
            mtd_encrypt_type = in_encrypt_type,
            mtd_version_no = in_version_no,
            mtd_update_timestamp = sysdate,
            mtd_update_user = in_update_user
      Where mtd_txn_id = in_txn_id
        and mtd_dtl_txn_id = in_dtl_txn_id;

     IF SQL%ROWCOUNT = 0 THEN
        insert into mms_txn_detail
                     (mtd_txn_id,
		      mtd_dtl_txn_id,
		      mtd_org_dtl_txn_id,
		      mtd_init_channel,
		      mtd_txn_code,
	              mtd_merchant_id,
		      mtd_psp_id,
	              mtd_mb_id,
	              mtd_bank_id,
		      mtd_party_node_id,
		      mtd_status,
		      mtd_ar_ind,
		      mtd_transmission_datetime,
		      mtd_isd_ind,
		      mtd_txn_amt,
		      mtd_txn_ccy,
		      mtd_adjustment,
		      mtd_exchange_rate,
		      mtd_processing_cost,
		      mtd_bank_charge,
		      mtd_bank_charge_refund,
		      mtd_filing_number,
                      mtd_country,
                      mtd_encrypt_type,
                      mtd_version_no,
                      mtd_create_user,
                      mtd_create_timestamp,
                      mtd_update_user,
                      mtd_update_timestamp
                      )
          values(in_txn_id,
       	         in_dtl_txn_id,
                 in_org_dtl_txn_id,
                 in_init_channel,
		 in_txn_code,
                 in_merchant_id,
                 in_psp_id,
                 in_mb_id,
                 in_bank_id,
		 in_party_node_id,
       		 in_status,
	         in_ar_ind,
		 in_transmission_datetime,
       		 in_isd_ind,
                 in_txn_amt,
		 in_txn_ccy,
	         in_adjustment,
		 in_exchange_rate,
		 in_processing_cost,
		 in_bank_charge,
		 in_bank_charge_refund,
		 in_filing_number,
                 in_country,
                 in_encrypt_type,
                 in_version_no,
                 in_create_user,
                 sysdate,
                 in_update_user,
                 sysdate
                 );

          IF SQL%ROWCOUNT = 0 THEN
             RETURN 1;
          ELSE
             RETURN 0;
          END IF;
      Else
          Return 0;
       End If;

EXCEPTION
  WHEN OTHERS THEN
     RETURN 9;
end sp_mms_txn_detail_insert;
/
