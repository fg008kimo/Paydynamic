CREATE OR REPLACE FUNCTION sp_email_sett_hist_insert (
   in_party_type	email_setting_history.esh_party_type%TYPE,
   in_party_id		email_setting_history.esh_party_id%TYPE,
   in_funct		email_setting_history.esh_funct%TYPE)
   RETURN NUMBER
IS
BEGIN
   INSERT INTO email_setting_history (esh_party_type,
				  esh_party_id,
				  esh_funct,
				  esh_default,
				  esh_disabled,
				  esh_create_user,
				  esh_create_timestamp)
      (SELECT es_party_type,
              es_party_id,
              es_funct,
              es_default,
              es_disabled,
              es_create_user,
              es_create_timestamp
         FROM email_setting
        WHERE es_party_type = in_party_type
	  AND es_party_id = in_party_id
	  AND es_funct = in_funct);

   IF SQL%ROWCOUNT = 0
   THEN
      RETURN 1;
   ELSE
      RETURN 0;
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      RETURN 9;
END sp_email_sett_hist_insert;
/

