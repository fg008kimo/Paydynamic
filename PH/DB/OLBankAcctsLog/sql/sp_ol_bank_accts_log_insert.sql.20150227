CREATE OR REPLACE FUNCTION sp_ol_bank_accts_log_insert (
   in_int_bank_code    ol_bank_accts_log.obl_int_bank_code%TYPE,
   in_bank_acct_num    ol_bank_accts_log.obl_bank_acct_num%TYPE)
   RETURN NUMBER
IS
BEGIN
   INSERT INTO ol_bank_accts_log (OBL_INT_BANK_CODE,
                                  OBL_BANK_ACCT_NUM,
                                  OBL_LOG_SEQ,
                                  OBL_ACCT_CCY,
                                  OBL_SHARED_ACCT,
                                  OBL_RECEIVED_DATETIME,
                                  OBL_RECEIVED_BY,
                                  OBL_REGISTERED_MOBILE,
                                  OBL_STATUS_TYPE,
                                  OBL_INIT_PROVIDER_ID,
                                  OBL_CREATE_TIMESTAMP,
                                  OBL_CREATE_USER,
                                  OBL_UPDATE_TIMESTAMP,
                                  OBL_UPDATE_USER,
                                  OBL_BANK_ACCT_NAME,
                                  OBL_OWNER_NAME,
                                  OBL_BRANCH_NAME,
                                  OBL_BANK_ACCT_SHORT_NAME,
                                  OBL_BRANCH_CODE,
                                  OBL_OWNER_ID,
                                  OBL_SWIFT_CODE,
                                  OBL_REMARK,
                                  OBL_SUPPORT_SMS_STMT,
                                  OBL_SYS_SWITCH_ENABLED,
                                  OBL_IS_MORE_RESTRICTED,
				  OBL_PROVINCE,
                                  OBL_CITY,
                                  OBL_ACCT_TYPE,
				  OBL_IS_VIRTUAL,
				  OBL_BANK_ACCT_SOURCE)
      (SELECT OB_INT_BANK_CODE,
              OB_BANK_ACCT_NUM,
              (SELECT NVL (MAX (obl_log_seq), 0) + 1
                 FROM ol_bank_accts_log
                WHERE     obl_int_bank_code = in_int_bank_code
                      AND obl_bank_acct_num = in_bank_acct_num),
              OB_ACCT_CCY,
              OB_SHARED_ACCT,
              OB_RECEIVED_DATETIME,
              OB_RECEIVED_BY,
              OB_REGISTERED_MOBILE,
              OB_STATUS_TYPE,
              OB_INIT_PROVIDER_ID,
              OB_CREATE_TIMESTAMP,
              OB_CREATE_USER,
              OB_UPDATE_TIMESTAMP,
              OB_UPDATE_USER,
              OB_BANK_ACCT_NAME,
              OB_OWNER_NAME,
              OB_BRANCH_NAME,
              OB_BANK_ACCT_SHORT_NAME,
              OB_BRANCH_CODE,
              OB_OWNER_ID,
              OB_SWIFT_CODE,
              OB_REMARK,
              OB_SUPPORT_SMS_STMT,
              OB_SYS_SWITCH_ENABLED,
              OB_IS_MORE_RESTRICTED,
              OB_PROVINCE,
              OB_CITY,
              OB_ACCT_TYPE,
	      OB_IS_VIRTUAL,
	      OB_BANK_ACCT_SOURCE
         FROM ol_bank_accts
        WHERE     OB_INT_BANK_CODE = in_int_bank_code
              AND OB_BANK_ACCT_NUM = in_bank_acct_num);

   IF SQL%ROWCOUNT = 0
   THEN
      RETURN 1;
   ELSE
      RETURN 0;
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      RETURN 9;
END sp_ol_bank_accts_log_insert;
/

