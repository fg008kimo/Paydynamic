CREATE OR REPLACE FUNCTION sp_ol_baid_txn_insert (
   in_txn_id                   ol_baid_txn.obt_txn_id%TYPE,
   in_org_txn_id               ol_baid_txn.obt_org_txn_id%TYPE,
   in_input_channel            ol_baid_txn.obt_input_channel%TYPE,
   in_status                   ol_baid_txn.obt_status%TYPE,
   in_ar_ind                   ol_baid_txn.obt_ar_ind%TYPE,
   in_sub_status               ol_baid_txn.obt_sub_status%TYPE,
   in_stat_txn_id              ol_baid_txn.obt_stat_txn_id%TYPE,
   in_org_voided_txn_id        ol_baid_txn.obt_org_voided_txn_id%TYPE,
   in_txn_code                 ol_baid_txn.obt_txn_code%TYPE,
   in_pid                      ol_baid_txn.obt_pid%TYPE,
   in_baid                     ol_baid_txn.obt_baid%TYPE,
   in_posting_date             ol_baid_txn.obt_posting_date%TYPE,
   in_transmission_datetime    ol_baid_txn.obt_transmission_datetime%TYPE,
   in_txn_ccy                  ol_baid_txn.obt_txn_ccy%TYPE,
   in_txn_amt                  ol_baid_txn.obt_txn_amt%TYPE,
   in_open_bal                 ol_baid_txn.obt_open_bal%TYPE,
   in_curr_bal                 ol_baid_txn.obt_curr_bal%TYPE,
   in_approval_date            ol_baid_txn.obt_approval_date%TYPE,
   in_approval_timestamp       VARCHAR2,
   in_dst_txn_id               ol_baid_txn.obt_dst_txn_id%TYPE,
   in_bank_code                ol_baid_txn.obt_bank_code%TYPE,
   in_bank_acct_num            ol_baid_txn.obt_bank_acct_num%TYPE,
   in_pid_txn_hold_ind         ol_baid_txn.obt_pid_txn_hold_ind%TYPE,
   in_pid_sys_match_ind        ol_baid_txn.obt_pid_sys_match_ind%TYPE,
   in_posted_ind               ol_baid_txn.obt_posted_ind%TYPE,
   in_remark                   ol_baid_txn.obt_remark%TYPE,
   in_recon_status             ol_baid_txn.obt_recon_status%TYPE,
   in_classified_status        ol_baid_txn.obt_classified_status%TYPE,
   in_est_net_amount           ol_baid_txn.obt_est_net_amount%TYPE,
   in_create_user              ol_baid_txn.obt_create_user%TYPE,
   in_update_user              ol_baid_txn.obt_update_user%TYPE)
   RETURN NUMBER
IS
BEGIN
   INSERT INTO ol_baid_txn (obt_txn_id,
                            obt_org_txn_id,
                            obt_input_channel,
                            obt_status,
                            obt_ar_ind,
                            obt_sub_status,
                            obt_stat_txn_id,
                            obt_org_voided_txn_id,
                            obt_txn_code,
                            obt_pid,
                            obt_baid,
                            obt_posting_date,
                            obt_transmission_datetime,
                            obt_txn_ccy,
                            obt_txn_amt,
                            obt_open_bal,
                            obt_curr_bal,
                            obt_approval_date,
                            obt_approval_timestamp,
                            obt_dst_txn_id,
                            obt_bank_code,
                            obt_bank_acct_num,
                            obt_pid_txn_hold_ind,
                            obt_pid_sys_match_ind,
                            obt_posted_ind,
                            obt_remark,
			    obt_recon_status,
			    obt_classified_status,
			    obt_est_net_amount,
                            obt_create_user,
                            obt_create_timestamp,
                            obt_update_user,
                            obt_update_timestamp)
        VALUES (in_txn_id,
                in_org_txn_id,
                in_input_channel,
                in_status,
                in_ar_ind,
                in_sub_status,
                in_stat_txn_id,
                in_org_voided_txn_id,
                in_txn_code,
                in_pid,
                in_baid,
                in_posting_date,
                in_transmission_datetime,
                in_txn_ccy,
                in_txn_amt,
                in_open_bal,
                in_curr_bal,
                in_approval_date,
                TO_TIMESTAMP(in_approval_timestamp, 'YYYYMMDDHH24MISSFF'),
                in_dst_txn_id,
                in_bank_code,
                in_bank_acct_num,
                in_pid_txn_hold_ind,
                in_pid_sys_match_ind,
                in_posted_ind,
		in_remark,
		in_recon_status,
		in_classified_status,
		in_est_net_amount,
                in_create_user,
                SYSDATE,
                in_update_user,
                SYSDATE);

   IF SQL%ROWCOUNT = 0
   THEN
      RETURN 1;
   ELSE
      RETURN 0;
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      RETURN 9;
END sp_ol_baid_txn_insert;
/

