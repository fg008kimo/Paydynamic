CREATE OR REPLACE FUNCTION sp_ol_txn_2_btxn_relation (
    in_txn_id           ol_recon_relation.orr_txn_id%type,
    out_cursor          out    sys_refcursor)

RETURN NUMBER Is
    iCnt    integer := 0;
Begin
    select count(*)
    into   iCnt    
    from   ol_recon_relation
    where  orr_txn_id = in_txn_id;

    if iCnt > 0 then
        OPEN out_cursor for
            select orr_baid_txn_id
            from ol_recon_relation
            where orr_txn_id = in_txn_id 
            order by orr_create_timestamp;

        RETURN 1;
    end if;

    RETURN 0;
exception
    WHEN OTHERS THEN
        RETURN 0;
END sp_ol_recon_find_txn_2_btxn;
/

