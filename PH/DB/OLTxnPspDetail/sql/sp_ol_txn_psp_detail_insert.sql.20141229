CREATE OR REPLACE FUNCTION sp_ol_txn_psp_detail_insert (
   in_txn_id           ol_txn_psp_detail.otp_txn_id%TYPE,
   in_psp_id           ol_txn_psp_detail.otp_psp_id%TYPE,
   in_baid             ol_txn_psp_detail.otp_baid%TYPE,
   in_txn_ccy          ol_txn_psp_detail.otp_txn_ccy%TYPE,
   in_txn_amount       ol_txn_psp_detail.otp_txn_amount%TYPE,
   in_txn_date         ol_txn_psp_detail.otp_txn_date%TYPE,
   in_txn_time         ol_txn_psp_detail.otp_txn_time%TYPE,
   in_bank_code        ol_txn_psp_detail.otp_bank_code%TYPE,
   in_bank_acct_num    ol_txn_psp_detail.otp_bank_acct_num%TYPE,
   in_cost             ol_txn_psp_detail.otp_cost%TYPE,
   in_open_bal         ol_txn_psp_detail.otp_open_bal%TYPE,
   in_total_hold       ol_txn_psp_detail.otp_total_hold%TYPE,
   in_bal              ol_txn_psp_detail.otp_bal%TYPE,
   in_prepaid          ol_txn_psp_detail.otp_prepaid%TYPE,
   in_open_in_transit  ol_txn_psp_detail.otp_open_in_transit%TYPE,
   in_in_transit       ol_txn_psp_detail.otp_in_transit%TYPE,
   in_pending_fund     ol_txn_psp_detail.otp_pending_fund%TYPE,
   in_txn_hold_ind     ol_txn_psp_detail.otp_txn_hold_ind%TYPE,
   in_sys_match_ind    ol_txn_psp_detail.otp_sys_match_ind%TYPE,
   in_customer_text    ol_txn_psp_detail.otp_customer_text%TYPE,
   in_sender_name      ol_txn_psp_detail.otp_sender_name%TYPE,
   in_txn_ref_num      ol_txn_psp_detail.otp_txn_ref_num%TYPE,
   in_create_user      ol_txn_psp_detail.otp_create_user%TYPE,
   in_update_user      ol_txn_psp_detail.otp_update_user%TYPE)
   RETURN NUMBER
IS
BEGIN
   INSERT INTO ol_txn_psp_detail (otp_txn_id,
                                  otp_psp_id,
                                  otp_baid,
                                  otp_txn_ccy,
                                  otp_txn_amount,
                                  otp_txn_date,
                                  otp_txn_time,
                                  otp_txn_timestamp,
                                  otp_bank_code,
                                  otp_bank_acct_num,
                                  otp_cost,
                                  otp_open_bal,
                                  otp_total_hold,
                                  otp_bal,
                                  otp_prepaid,
                                  otp_open_in_transit,
                                  otp_in_transit,
                                  otp_pending_fund,
                                  otp_txn_hold_ind,
                                  otp_sys_match_ind,
                                  otp_customer_text,
                                  otp_sender_name,
                                  otp_txn_ref_num,
                                  otp_create_user,
                                  otp_create_timestamp,
                                  otp_update_user,
                                  otp_update_timestamp)
        VALUES (in_txn_id,
                in_psp_id,
                in_baid,
                in_txn_ccy,
                in_txn_amount,
                in_txn_date,
                in_txn_time,
                TO_DATE (in_txn_date || in_txn_time, 'yyyymmddhh24miss'),
                in_bank_code,
                in_bank_acct_num,
                in_cost,
                in_open_bal,
                in_total_hold,
                in_bal,
                in_prepaid,
                in_open_in_transit,
                in_in_transit,
                in_pending_fund,
                in_txn_hold_ind,
                in_sys_match_ind,
                in_customer_text,
                in_sender_name,
                in_txn_ref_num,
                in_create_user,
                SYSDATE,
                in_update_user,
                SYSDATE);

   IF SQL%ROWCOUNT = 0
   THEN
      RETURN 1;
   ELSE
      RETURN 0;
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      RETURN 9;
END sp_ol_txn_psp_detail_insert;
/

