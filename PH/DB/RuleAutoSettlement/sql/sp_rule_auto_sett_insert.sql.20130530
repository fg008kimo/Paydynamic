CREATE OR REPLACE FUNCTION sp_rule_auto_sett_insert(
	in_rs_type		rule_auto_settlement.rs_type%type,
	in_rs_value		rule_auto_settlement.rs_value%type,
	in_rs_desc		rule_auto_settlement.rs_desc%type,
	in_create_user		rule_auto_settlement.rs_create_user%type,
	out_rule_id	OUT 	rule_auto_settlement.rs_id%type)
  RETURN NUMBER IS
	
BEGIN

  	select NVL(max(rs_id), 0)
	into out_rule_id
	from rule_auto_settlement;

	out_rule_id := out_rule_id + 1;


  INSERT INTO rule_auto_settlement(
	rs_id,
	rs_type,
	rs_value,
	rs_desc,
	rs_disabled,
	rs_create_timestamp,
	rs_create_user,
        rs_update_timestamp,
        rs_update_user
	)

  VALUES(
	out_rule_id,
	in_rs_type,
	in_rs_value,
	in_rs_desc,
        0,
	sysdate,
	in_create_user,
        sysdate,
        in_create_user
	);

  IF SQL%ROWCOUNT = 0 THEN
     RETURN 1;
  ELSE
     RETURN 0;
  END IF;

EXCEPTION
  WHEN OTHERS THEN
     RETURN 9;

END sp_rule_auto_sett_insert;
/
