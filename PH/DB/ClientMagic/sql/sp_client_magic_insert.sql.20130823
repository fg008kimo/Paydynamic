CREATE OR REPLACE FUNCTION sp_client_magic_insert(
	in_client_id		client_magic.cm_client_id%type,
	in_cust_id		client_magic.cm_cust_id%type,
	in_num			client_magic.cm_num%type,
	in_word			client_magic.cm_word%type,
	in_disabled		client_magic.cm_disabled%type,
	in_create_user		client_magic.cm_create_user%type
)
return number is
begin
	update client_magic
	  set cm_disabled = in_disabled,
	      cm_num = in_num,
	      cm_word = in_word,
              cm_update_user = in_create_user,
	      cm_update_timestamp = sysdate
        where cm_client_id = in_client_id
	  and cm_cust_id = in_cust_id;

	if SQL%ROWCOUNT = 0 THEN
		insert into client_magic
                        (cm_client_id,
                         cm_cust_id,
                         cm_num,
                         cm_word,
                         cm_disabled,
                         cm_create_user,
                         cm_update_user,
                         cm_create_timestamp,
                         cm_update_timestamp)
                values(in_client_id,
                       in_cust_id,
                       in_num,
                       in_word,
                       in_disabled,
                       in_create_user,
                       in_create_user,
                       sysdate,
                       sysdate);
                if SQL%ROWCOUNT = 0 THEN
			return 1;
		else
                        return 0;
                end if;

	else
		return 0;
	end if;

exception
  when others then
  return 9;
end sp_client_magic_insert;
/
