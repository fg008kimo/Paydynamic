CREATE OR REPLACE FUNCTION sp_ol_deposit_detail_insert(
	in_filename		ol_deposit_request_detail.oldd_filename%type,
	in_deposit_seq		ol_deposit_request_detail.oldd_deposit_seq%type,
	in_merchant_ref		ol_deposit_request_detail.oldd_merchant_ref%type,
	in_country		ol_deposit_request_detail.oldd_country%type,
	in_deposit_datetime	IN VARCHAR2,
	in_deposit_bank		ol_deposit_request_detail.oldd_deposit_bank%type,
	in_deposit_ref		ol_deposit_request_detail.oldd_deposit_ref%type,
	in_deposit_amount	ol_deposit_request_detail.oldd_deposit_amount%type,
	in_deposit_ccy		ol_deposit_request_detail.oldd_deposit_ccy%type,
	in_create_user		ol_deposit_request_detail.oldd_create_user%type)
  RETURN NUMBER IS
	out_datetime		ol_deposit_request_detail.oldd_deposit_datetime%type;
	out_of_datetime		EXCEPTION;
BEGIN
	BEGIN
		SELECT	to_char(to_date(in_deposit_datetime,'YYYY-MM-DD HH24:MI:SS'),'YYYYMMDDHH24MISS')
		INTO	out_datetime
		FROM	DUAL;
	EXCEPTION
		WHEN	OTHERS THEN
			RAISE out_of_datetime;
	END;

	INSERT INTO ol_deposit_request_detail (
		oldd_filename,
		oldd_deposit_seq,
		oldd_merchant_ref,
		oldd_country,
		oldd_deposit_datetime,
		oldd_deposit_bank,
		oldd_deposit_ref,
		oldd_deposit_amount,
		oldd_deposit_ccy,
		oldd_create_timestamp,
		oldd_create_user,
		oldd_update_timestamp,
		oldd_update_user
		)
	VALUES (	
		in_filename,
		in_deposit_seq,
		in_merchant_ref,
		in_country,
		out_datetime,
		in_deposit_bank,
		in_deposit_ref,
		in_deposit_amount,
		in_deposit_ccy,
		sysdate,
		in_create_user,
		sysdate,
		in_create_user
		);

	IF SQL%ROWCOUNT = 0 THEN
		RETURN 1;
	ELSE
		RETURN 0;
	END IF;

EXCEPTION
	WHEN	out_of_datetime THEN
		RETURN 8;
	WHEN	OTHERS THEN
		RETURN 9;

END sp_ol_deposit_detail_insert;
/
