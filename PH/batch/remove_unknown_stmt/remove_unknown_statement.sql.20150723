set serveroutput on;
set verify off;

declare
    v_file_id   ol_statement_header.olsh_file_id%type;

begin

    for i in (select olsh_file_id 
              from ol_statement_header 
              where olsh_create_timestamp >= to_date('&&DateFrom', 'YYYYMMDD')
              and olsh_create_timestamp < to_date('&&DateTo', 'YYYYMMDD')
              and olsh_create_user = 'SYSTEM'
              and olsh_message_code = 0) loop

        -- .... need to check before if any not unknown .... --
        v_file_id := i.olsh_file_id;
    
        for i in (select olsd_stat_txn_id
                  from  ol_statement_detail 
                  where olsd_file_id = v_file_id) loop

            delete from ol_statement_detail where olsd_stat_txn_id = i.olsd_stat_txn_id;    
dbms_output.put_line('ol_statement_detail del [' || i.olsd_stat_txn_id || '] sql%rowcount [' || sql%rowcount || ']');
        
            delete from ol_baid_txn where obt_stat_txn_id = i.olsd_stat_txn_id;      
dbms_output.put_line('ol_baid_txn del [' || i.olsd_stat_txn_id || '] sql%rowcount [' || sql%rowcount || ']');        

        end loop;
    
        delete from ol_statement_header where olsh_file_id = v_file_id;
dbms_output.put_line('ol_statement_header del [' || v_file_id || '] [' || sql%rowcount || ']');     

    end loop;

end;
/
