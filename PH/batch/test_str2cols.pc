#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdint.h>
#include <unistd.h>
#include <ctype.h>
#include <sqlca.h>
#include <sys/types.h>
#include <time.h>
#include "common.h"
#include "utilitys.h"
#include "curl/curl.h"
#include "ObjPtr.h"
#include "myrecordset.h"
#include <wchar.h>
#include <locale.h>


#define SQLCA_STORAGE_CLASS extern
#define SQLCODE sqlca.sqlcode
#define MAX_MSG_SIZE 4096

#define TOKEN_SIGN    "|"
#define FIELD_TOKEN   "="

OBJPTR(BO);


char	cDebug='Y';


int batch_init(int argc, char* argv[])
{
        return SUCCESS;
}


int batch_proc(int argc, char* argv[])
{
	int iRet = SUCCESS;


	char inMsg[1024];
        char    *csReturnCode = NULL;
        hash_t  *hRec;

        hRec = (hash_t*) malloc (sizeof(hash_t));
        hash_init(hRec,0);

	memset(inMsg, 0, sizeof(inMsg));
	sprintf(inMsg, "%s", "return_code=SUCCESS|return_msg=|mid=TEST|order_id=0000500000019416|order_amount=1000|code_url=https://hstraining.online/paypage/qrpsp/qrs/?order_id=0000500000019416|signature=8b605e7010888974980c67b4e4b12bc7");

        if (Str2Cls(hRec,(char*)inMsg,TOKEN_SIGN,FIELD_TOKEN) == PD_OK) {

printf("enter the TRUE case !\n");

                if (GetField_CString(hRec,"return_code",&csReturnCode)) {
printf("csReturnCode = [%s]\n", csReturnCode);

		} else {
printf("cannot get return_code !\n");
		}

	} else {
printf("enter the FALSE case !\n");
	}

	hash_destroy(hRec);
        FREE_ME(hRec);

	return iRet;
}



int batch_terminate(int argc, char* argv[])
{
    return SUCCESS;
}

